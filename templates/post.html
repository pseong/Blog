{% extends 'base.html' %}
{% block content %}
<script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
<!-- Post Content Column -->
<div>

  <!-- Category -->
  <h5 class="mt-4 text-center"><a class="mt-4 text-muted"
      href="{{ url_for('category', category_id=post['category']) }}">{{ post['category'] }}</a></h5>

  <!-- Title -->
  <h3 class="mt-3 text-center">{{ post['title'] }}</h3>
  
  <!-- Author -->
  <h5 class="mb-0"><a class="text-dark" href="#">{{ post['author']}}</a></h5>
  
  <!-- Date/Time -->
  <a class="text-muted">{{ post['date'] }}</a>

  <hr>

  <!-- Post Content -->
  {{ markdown.markdown(post.content, extensions=['nl2br', 'fenced_code', 'tables'])|safe }}
  
  <span>
    <a onclick="sendLinkKakao();" id="kakao-link-btn" title="카카오톡으로 공유">
        <img src="{{url_for('static',filename='images/kakao.png')}}" width=36 alt="Kakaotalk">
    </a>
  </span>
  
  <span>
    <a id="toast" onclick="copyLink();" title="링크 복사">
      <img src="{{url_for('static',filename='images/linkcopy.png')}}" width=36>
    </a>
  </span>
  {% include 'disqus.html' %}
  
</div>
{% set soup = BeautifulSoup(markdown.markdown(post.content[0:600], extensions=['nl2br', 'fenced_code', 'tables'])|safe) %}

<script src="sweetalert2.min.js"></script>
<link rel="stylesheet" href="sweetalert2.min.css">

<script>
  /* 링크복사 */
  function copyLink(){
    alert("복사 되었습니다.");
    var dummy = document.createElement("textarea");
    document.body.appendChild(dummy);
    dummy.value = "https://pseong.kr/post/{{ post_id }}";
    dummy.select();
    document.execCommand("copy");
    document.body.removeChild(dummy);
  }
  $().ready(function () {
    $("#toast").click(function () {
      const Toast = Swal.mixin({
        toast: true,
        position: 'center-center',
        showConfirmButton: false,
        timer: 3000,
        timerProgressBar: true,
        didOpen: (toast) => {
          toast.addEventListener('mouseenter', Swal.stopTimer);
          toast.addEventListener('mouseleave', Swal.resumeTimer);
        }
      })

      Toast.fire({
          icon: 'success',
          title: 'toast 알림이 정상적으로 실행 되었습니다.'
      })
    });
  });
  /* 카카오톡 */
  Kakao.init('90109f360ea531e3481252cf5482d9ed');
  function sendLinkKakao(){
    Kakao.Link.sendDefault({
      objectType: 'feed',
      content: {
        title: "{{ post['title'] }}",
        description: "{{ post['title'] }}",
        imageUrl: "https://pseong.kr{{url_for('static',filename='images/pic.png')}}",
        link: {
          mobileWebUrl: 'https://pseong.kr/post/{{ post_id }}',
          webUrl: 'https://pseong.kr/post/{{ post_id }}'
        }
      },
      buttons: [       
        {
          title: '링크 열기',
          link: {
            mobileWebUrl: 'https://pseong.kr/post/{{ post_id }}',
            webUrl: 'https://pseong.kr/post/{{ post_id }}'
          }
        }
      ]
    }); 
  }
</script>
{% endblock %}